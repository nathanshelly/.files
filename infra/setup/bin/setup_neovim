#! /usr/bin/env bash

# setup work-related config
# at the moment the only thing to setup is a work-specific gitconfig

# check that DOTFILES variable is defined
# shellcheck disable=SC1090
source "${BASH_SOURCE%/*}/../check_dotfiles_variable.sh"

source "$DOTFILES/infra/scripts/prompts.sh"

# interactively confirm that neovim should be set up in non-headless install
[[ -z $DOTFILES_SETUP_HEADLESS ]] && {
  user "set up neovim? (y/any other key)"

  read -r -n 1 maybe_continue < /dev/tty
  echo # avoid writing on same line as user input

  [[ $maybe_continue != 'y' ]] && {
    info "skipping neovim setup"
    exit 0
  }
}

# install vim-plug - https://github.com/junegunn/vim-plug
info 'Installing vim-plug'
sh -c "curl --create-dirs \
  -fLo \"${XDG_DATA_HOME:-$HOME/.local/share}\"/nvim/site/autoload/plug.vim \
  'https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim'"

info 'installing vim plugins'
# install vim plugins
nvim -c PlugInstall -c qa
